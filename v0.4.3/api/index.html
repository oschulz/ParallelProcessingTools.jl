<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · ParallelProcessingTools</title><link rel="canonical" href="https://oschulz.github.io/ParallelProcessingTools.jl/stable/api/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ParallelProcessingTools</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Functions-and-macros"><span>Functions and macros</span></a></li><li class="toplevel"><a class="tocitem" href="#Documentation"><span>Documentation</span></a></li></ul></li><li><a class="tocitem" href="../LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><ul><li><a href="#ParallelProcessingTools.AbstractThreadLocal"><code>ParallelProcessingTools.AbstractThreadLocal</code></a></li><li><a href="#ParallelProcessingTools.ThreadLocal"><code>ParallelProcessingTools.ThreadLocal</code></a></li></ul><h2 id="Functions-and-macros"><a class="docs-heading-anchor" href="#Functions-and-macros">Functions and macros</a><a id="Functions-and-macros-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-macros" title="Permalink"></a></h2><ul><li><a href="#ParallelProcessingTools.@critical-Tuple{Any}"><code>ParallelProcessingTools.@critical</code></a></li><li><a href="#ParallelProcessingTools.@mp_async-Tuple{Any}"><code>ParallelProcessingTools.@mp_async</code></a></li><li><a href="#ParallelProcessingTools.@mt_async-Tuple{Any}"><code>ParallelProcessingTools.@mt_async</code></a></li><li><a href="#ParallelProcessingTools.@mt_out_of_order-Tuple{Any}"><code>ParallelProcessingTools.@mt_out_of_order</code></a></li><li><a href="#ParallelProcessingTools.@onprocs-Tuple{Any,Any}"><code>ParallelProcessingTools.@onprocs</code></a></li><li><a href="#ParallelProcessingTools.@onthreads-Tuple{Any,Any}"><code>ParallelProcessingTools.@onthreads</code></a></li><li><a href="#ParallelProcessingTools.allthreads-Tuple{}"><code>ParallelProcessingTools.allthreads</code></a></li><li><a href="#ParallelProcessingTools.getallvalues"><code>ParallelProcessingTools.getallvalues</code></a></li><li><a href="#ParallelProcessingTools.getlocalvalue"><code>ParallelProcessingTools.getlocalvalue</code></a></li><li><a href="#ParallelProcessingTools.workpart"><code>ParallelProcessingTools.workpart</code></a></li></ul><h1 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.AbstractThreadLocal" href="#ParallelProcessingTools.AbstractThreadLocal"><code>ParallelProcessingTools.AbstractThreadLocal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type AbstractThreadLocal{T} end</code></pre><p>Abstract type for thread-local values of type <code>T</code>.</p><p>The value for the current thread is accessed via <code>getindex(::AbstractThreadLocal)</code> and `setindex(::AbstractThreadLocal, x).</p><p>To access both regular and thread-local values in a unified manner, use the function <a href="#ParallelProcessingTools.getlocalvalue"><code>getlocalvalue</code></a>.</p><p>To get the all values across all threads, use the function <a href="#ParallelProcessingTools.getallvalues"><code>getallvalues</code></a>.</p><p>Default implementation is <a href="#ParallelProcessingTools.ThreadLocal"><code>ThreadLocal</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/threadlocal.jl#L4-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.ThreadLocal" href="#ParallelProcessingTools.ThreadLocal"><code>ParallelProcessingTools.ThreadLocal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ThreadLocal{T} &lt;: AbstractThreadLocal{T}</code></pre><p>Represents a thread-local value. See <a href="#ParallelProcessingTools.AbstractThreadLocal"><code>AbstractThreadLocal</code></a> for the API.</p><p>Constructors:</p><pre><code class="language-julia">ThreadLocal{T}() where {T}
ThreadLocal(value::T) where {T}
ThreadLocal{T}(f::Base.Callable) where {T}</code></pre><p>Examples:</p><pre><code class="language-julia">tlvalue = ThreadLocal(0)
@onthreads allthreads() tlvalue[] = Base.Threads.threadid()
getallvalues(tlvalue) == allthreads()</code></pre><pre><code class="language-julia">rand_value_on_each_thread = ThreadLocal{Float64}(rand)
all(x -&gt; 0 &lt; x &lt; 1, getallvalues(rand_value_on_each_thread))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/threadlocal.jl#L54-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.@critical-Tuple{Any}" href="#ParallelProcessingTools.@critical-Tuple{Any}"><code>ParallelProcessingTools.@critical</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@critical expr</code></pre><p>Mark code in <code>expr</code> as a critical section. Code in critical sections will never be executed in parallel (via multithreading) to any other critical section.</p><p><code>@critical</code> is very useful to mark non-threadsafe code.</p><p>Example:</p><pre><code class="language-julia">@onthreads allthreads() begin
    @critical @info Base.Threads.threadid()
end

Without `@critical`, the above will typically crash Julia.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/threadsafe.jl#L100-L118">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.@mp_async-Tuple{Any}" href="#ParallelProcessingTools.@mp_async-Tuple{Any}"><code>ParallelProcessingTools.@mp_async</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@mp_async expr</code></pre><p>Run <code>expr</code> asynchronously on a worker process.</p><p>Compatible with <code>@sync</code>.</p><p>Equivalent to <code>Distributed.@spawn expr</code> on Julia &lt;= v1.2, equivalent to <code>Distributed.@spawn :any expr</code> on Julia &gt;= v1.3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/onprocs.jl#L36-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.@mt_async-Tuple{Any}" href="#ParallelProcessingTools.@mt_async-Tuple{Any}"><code>ParallelProcessingTools.@mt_async</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@mt_async expr</code></pre><p>Spawn a Julia task running <code>expr</code> asynchronously.</p><p>Compatible with <code>@sync</code>. Uses a multi-threaded task scheduler if available (on Julia &gt;= v1.3).</p><p>Equivalent to <code>Base.@async</code> on Julia &lt;= v1.2, equivalent to <code>Base.Threads.@spawn</code> on Julia &gt;= v1.3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/onthreads.jl#L198-L208">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.@mt_out_of_order-Tuple{Any}" href="#ParallelProcessingTools.@mt_out_of_order-Tuple{Any}"><code>ParallelProcessingTools.@mt_out_of_order</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@mt_out_of_order begin expr... end</code></pre><p>Runs all top-level expressions in <code>begin expr... end</code> on parallel tasks. On Julia &gt;= v1.3, the tasks will run multi-threaded.</p><p>Example:</p><p>``` @mt<em>out</em>of_order begin     a = foo()     bar()     c = baz() end</p><p>will run <code>a = foo()</code>, <code>bar()</code> and <code>c = baz()</code> in parallel and in arbitrary order, results of assignments will appear in the outside scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/onthreads.jl#L228-L245">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.@onprocs-Tuple{Any,Any}" href="#ParallelProcessingTools.@onprocs-Tuple{Any,Any}"><code>ParallelProcessingTools.@onprocs</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@onprocs procsel expr</code></pre><p>Executes <code>expr</code> in parallel on all processes in <code>procsel</code>. Waits until all processes are done. Returns all results as a vector (or as a single scalar value, if <code>procsel</code> itself is a scalar).</p><p>Example:</p><pre><code class="language-julia">using Distributed
addprocs(2)
workers() == @onprocs workers() myid()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/onprocs.jl#L10-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.@onthreads-Tuple{Any,Any}" href="#ParallelProcessingTools.@onthreads-Tuple{Any,Any}"><code>ParallelProcessingTools.@onthreads</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia">@onthreads threadsel expr</code></pre><p>Execute code in <code>expr</code> in parallel on the threads in <code>threadsel</code>.</p><p><code>threadsel</code> should be a single thread-ID or a range (or array) of thread-ids. If <code>threadsel == Base.Threads.threadid()</code>, <code>expr</code> is run on the current tread with only minimal overhead.</p><p>Note: Currently, multiple <code>@onthreads</code> sections will not run in parallel to each other, even if they use disjunct sets of threads, due to limitations of the Julia multithreading implementation. This restriction is likely to disappear in future Julia versions.</p><p>In contrast to <code>Base.Threads.@threads</code>, <code>@onthreads</code> does forward exceptions to the caller.</p><p>Example 1:</p><pre><code class="language-juliaexpr">tlsum = ThreadLocal(0.0)
data = rand(100)
@onthreads allthreads() begin
    tlsum[] = sum(workpart(data, allthreads(), Base.Threads.threadid()))
end
sum(getallvalues(tlsum)) ≈ sum(data)</code></pre><p>Example 2:</p><pre><code class="language-julia"># Assuming 4 threads:
tl = ThreadLocal(42)
threadsel = 2:3
@onthreads threadsel begin
    tl[] = Base.Threads.threadid()
end
getallvalues(tl)[threadsel] == [2, 3]
getallvalues(tl)[[1,4]] == [42, 42]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/onthreads.jl#L134-L174">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.allthreads-Tuple{}" href="#ParallelProcessingTools.allthreads-Tuple{}"><code>ParallelProcessingTools.allthreads</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">allthreads()</code></pre><p>Convencience function, returns <code>1:Base.Threads.nthreads()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/onthreads.jl#L125-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.getallvalues" href="#ParallelProcessingTools.getallvalues"><code>ParallelProcessingTools.getallvalues</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">getallvalues(v::AbstractThreadLocal{T})::AbstractVector{T}</code></pre><p>Access the all values (one for each thread) of a thread-local value as a vector. Can only be called in single-threaded code sections.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/threadlocal.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.getlocalvalue" href="#ParallelProcessingTools.getlocalvalue"><code>ParallelProcessingTools.getlocalvalue</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">getlocalvalue(x::Any) = x
getlocalvalue(x::ThreadLocal) = x[]</code></pre><p>Access plain values and thread-local values in a unified fashion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/threadlocal.jl#L27-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParallelProcessingTools.workpart" href="#ParallelProcessingTools.workpart"><code>ParallelProcessingTools.workpart</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">workpart(data::AbstractArray, workersel::AbstractVector{W}, current_worker::W) where {W}</code></pre><p>Get the part of <code>data</code> that the execution unit <code>current_worker</code> is responsible for. Implies a partition of <code>data</code> across the workers listed in <code>workersel</code>.</p><p>For generic <code>data</code> arrays, <code>workpart</code> will return a view. If <code>data</code> is a <code>Range</code> (e.g. indices to be processed), a sub-range will be returned.</p><p>Type <code>W</code> will typically be <code>Int</code> and <code>workersel</code> will usually be a range/array of thread/process IDs.</p><p>Note: <code>workersel</code> is required to be sorted in ascending order and to contain no duplicate entries.</p><p>Examples:</p><pre><code class="language-julia">using Distributed, Base.Threads
A = rand(100)
# ...
sub_A = workpart(A, workers(), myid())
# ...
idxs = workpart(eachindex(sub_A), allthreads(), threadid())
for i in idxs
    # ...
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ParallelProcessingTools.jl/blob/a9e01f363b59a0cb546ec378d40312d815840cce/src/workpartition.jl#L62-L91">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../LICENSE/">LICENSE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 4 February 2021 22:40">Thursday 4 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
